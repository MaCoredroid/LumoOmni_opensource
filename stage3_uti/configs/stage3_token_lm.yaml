run_name: stage3_token_lm
seed: 42
output_dir: outputs/stage3_token_lm

uti:
  config_path: configs/uti.yaml
  token_space_json: outputs/stage3_token_lm/token_space.json

model:
  base_llm: Qwen/Qwen3-8B-Base
  vocab_size_override: null  # set to token_space vocab_size_total

train:
  output_dir: outputs/stage3_token_lm
  max_seq_len: 2048
  truncation_side: left
  batch_size: 1
  gradient_accum: 16
  lr: 1.0e-3
  lr_embed: 1.0e-3
  lr_head: 1.0e-3
  weight_decay: 0.0
  num_epochs: 1
  save_every: 1000
  log_every: 50
  grad_clip: 1.0
  precision: bf16
  attn_implementation: sdpa
  freeze_base: true
  device_map: cuda
  low_cpu_mem_usage: true

# Dataset schema (JSONL) expected by future pipeline
# - text: string
# - image_path: optional
# - audio_path: optional
# - task: t2a|t2i|a2t|i2t|...
# - id: unique

data:
  jsonl_path: outputs/stage3_token_lm/train.jsonl
  num_workers: 4
