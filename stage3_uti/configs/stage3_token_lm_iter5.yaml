run_name: stage3_token_lm_iter5
seed: 42
output_dir: outputs/stage3_token_lm_iter5

uti:
  config_path: configs/uti.yaml
  token_space_json: outputs/stage3_token_lm/token_space.json

model:
  base_llm: Qwen/Qwen3-8B-Base
  vocab_size_override: null

train:
  output_dir: outputs/stage3_token_lm_iter5
  max_seq_len: 2048
  truncation_side: left
  batch_size: 1
  gradient_accum: 16
  lr: 1.0e-3
  lr_embed: 1.0e-3
  lr_head: 1.0e-3
  weight_decay: 0.0
  num_epochs: 5
  save_every: 1000
  log_every: 50
  grad_clip: 1.0
  precision: bf16
  attn_implementation: sdpa
  freeze_base: true
  device_map: cuda
  low_cpu_mem_usage: true
  save_trainable_only: true
  resume_from: outputs/stage3_token_lm_iter5/checkpoint_12000
  log_embed_stats: true
  eval_ablation_every: 1000
  eval_ablation_jsonl: outputs/stage3_token_lm/eval.small_512.jsonl
  eval_ablation_audio_n: 64
  eval_ablation_image_n: 64
  eval_ablation_seed: 123
  eval_ablation_log: outputs/stage3_token_lm_iter5/ablation_log.jsonl

data:
  jsonl_path: outputs/stage3_token_lm/train.small_8192.jsonl
  num_workers: 4
